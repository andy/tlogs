(function(d){var b="ar"+ +new Date,e=c.defaults={onResize:function(){},onBeforeResize:function(){return 123},onAfterResize:function(){return 555},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};c.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"];c.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden"};c.resizableFilterSelector=["textarea:not(textarea."+b+")","input:not(input[type])","input[type=text]","input[type=password]","input[type=email]","input[type=url]"].join(",");c.AutoResizer=a;d.fn.autoResize=c;function c(f){this.filter(c.resizableFilterSelector).each(function(){new a(d(this),f)});return this}function a(g,f){if(g.data("AutoResizer")){g.data("AutoResizer").destroy()}f=this.config=d.extend({},c.defaults,f);this.el=g;this.nodeName=g[0].nodeName.toLowerCase();this.originalHeight=g.height();this.previousScrollTop=null;this.value=g.val();if(f.maxWidth==="original"){f.maxWidth=g.width()}if(f.minWidth==="original"){f.minWidth=g.width()}if(f.maxHeight==="original"){f.maxHeight=g.height()}if(f.minHeight==="original"){f.minHeight=g.height()}if(this.nodeName==="textarea"){g.css({resize:"none",overflowY:"hidden"})}g.data("AutoResizer",this);f.animate.complete=(function(h){return function(){f.onAfterResize.call(g);return h.apply(this,arguments)}}(f.animate.complete));this.bind()}a.prototype={bind:function(){var f=d.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",f).bind("change.autoResize",f).bind("paste.autoResize",function(){setTimeout(function(){f()},0)});if(!this.el.is(":hidden")){this.check(null,true)}},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var f=this.el,g=this.nodeName==="textarea"?f.clone():d("<span/>");this.clone=g;d.each(c.cloneCSSProperties,function(h,j){g[0].style[j]=f.css(j)});g.removeAttr("name").removeAttr("id").addClass(b).attr("tabIndex",-1).css(c.cloneCSSValues);if(this.nodeName==="textarea"){g.height("auto")}else{g.width("auto").css({whiteSpace:"nowrap"})}},check:function(l,j){if(!this.clone){this.createClone();this.injectClone()}var i=this.config,m=this.clone,h=this.el,n=h.val();if(n===this.prevValue){return true}this.prevValue=n;if(this.nodeName==="input"){m.text(n);var o=m.width(),k=(o+i.extraSpace)>=i.minWidth?o+i.extraSpace:i.minWidth,g=h.width();k=Math.min(k,i.maxWidth);if((k<g&&k>=i.minWidth)||(k>=i.minWidth&&k<=i.maxWidth)){i.onBeforeResize.call(h);i.onResize.call(h);h.scrollLeft(0);if(i.animate&&!j){h.stop(1,1).animate({width:k},i.animate)}else{h.width(k);i.onAfterResize.call(h)}}return}m.width(h.width()).height(0).val(n).scrollTop(10000);var f=m[0].scrollTop;if(this.previousScrollTop===f){return}this.previousScrollTop=f;if(f+i.extraSpace>=i.maxHeight){h.css("overflowY","");f=i.maxHeight;j=true}else{if(f<=i.minHeight){f=i.minHeight}else{h.css("overflowY","hidden");f+=i.extraSpace}}i.onBeforeResize.call(h);i.onResize.call(h);if(i.animate&&!j){h.stop(1,1).animate({height:f},i.animate)}else{h.height(f);i.onAfterResize.call(h)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clone.remove();delete this.el;delete this.clone},injectClone:function(){(c.cloneContainer||(c.cloneContainer=d("<arclones/>").appendTo("body"))).append(this.clone)}}})(jQuery);
